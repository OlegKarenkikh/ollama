#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–±–æ—Ä–∫–∏

echo "=== –°–¢–ê–¢–£–° –°–ë–û–†–ö–ò –ö–û–ù–¢–ï–ô–ù–ï–†–û–í ==="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–±–æ—Ä–∫–∏
if ps aux | grep -v grep | grep "build_all_variants.sh" > /dev/null; then
    echo "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ –∑–∞–ø—É—â–µ–Ω"
else
    echo "‚ùå –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

echo ""
echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞ —Å–±–æ—Ä–∫–∏:"
tail -30 /tmp/build_all_output.log | grep -E "‚úÖ|‚ùå|üî®|üì§|–í–ê–†–ò–ê–ù–¢|DONE|ERROR" | tail -20

echo ""
echo "–ó–∞–ø—É—â–µ–Ω–Ω—ã–µ Docker build –ø—Ä–æ—Ü–µ—Å—Å—ã:"
sudo docker ps | grep buildx || echo "–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö build –ø—Ä–æ—Ü–µ—Å—Å–æ–≤"

echo ""
echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã:"
sudo docker images olegkarenkikh/ollama 2>/dev/null | head -10 || echo "–û–±—Ä–∞–∑—ã –µ—â–µ –Ω–µ —Å–æ–±—Ä–∞–Ω—ã"
